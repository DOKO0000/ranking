<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Acceso - Roblox PvP</title>
    <link rel="stylesheet" href="style.css"> </head>
<body>
    <div class="auth-container">
        <h1>ðŸŽ® PvP Battle Logs</h1>
        <div class="box">
            <input id="username" type="text" placeholder="Tu Usuario de Roblox">
            <button onclick="auth()">Entrar / Registrarse</button>
        </div>
        <p id="msg"></p>
        <a href="ranking.html">Ver Ranking Global</a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { databaseURL: "https://ayudaaa-98eff-default-rtdb.firebaseio.com/" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.auth = async () => {
            const user = document.getElementById('username').value.trim().toLowerCase();
            if(!user) return;

            const userRef = ref(db, 'usuarios/' + user);
            const snap = await get(userRef);

            if(!snap.exists()) {
                await set(userRef, { nombre: user, victorias: 0, registrado: Date.now() });
            }
            
            localStorage.setItem("sessionUser", user);
            window.location.href = "perfil.html";
        };
    </script>
</body>
</html>
